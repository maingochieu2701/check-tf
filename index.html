<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Traffic90 Ultimate Tool v10.2 FINAL</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", sans-serif;
      }
      :root {
        --p: #667eea;
        --s: #764ba2;
        --ok: #10b981;
        --no: #ef4444;
        --w: #f59e0b;
        --bg: #fff;
        --sub: #f5f7fa;
        --t: #333;
        --ts: #666;
        --b: #e0e0e0;
      }
      body.dark-mode {
        --p: #8b9dff;
        --s: #a98ec9;
        --bg: #1a1a2e;
        --sub: #16213e;
        --t: #e4e4e7;
        --ts: #a1a1aa;
        --b: #3f3f46;
      }
      body {
        background: linear-gradient(135deg, var(--p), var(--s));
        min-height: 100vh;
        color: var(--t);
        padding: 20px;
      }
      .container {
        max-width: 1450px;
        margin: auto;
        background: var(--bg);
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
        overflow: hidden;
      }
      .header {
        background: linear-gradient(135deg, var(--p), var(--s));
        color: #fff;
        padding: 35px;
        text-align: center;
        position: relative;
      }
      .header h1 {
        font-size: 34px;
        margin-bottom: 8px;
        animation: g 2s infinite alternate;
      }
      @keyframes g {
        from {
          text-shadow: 0 0 20px #fff;
        }
        to {
          text-shadow: 0 0 40px var(--p);
        }
      }
      .v {
        position: absolute;
        top: 20px;
        right: 20px;
        background: #ff006e;
        padding: 10px 22px;
        border-radius: 30px;
        font-weight: 900;
        color: #fff;
        animation: p 2s infinite;
      }
      @keyframes p {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.15);
        }
      }
      .toggle {
        position: absolute;
        top: 20px;
        left: 20px;
        background: rgba(255, 255, 255, 0.3);
        border: none;
        color: #fff;
        padding: 12px 20px;
        border-radius: 30px;
        cursor: pointer;
        font-size: 20px;
      }
      textarea {
        width: 100%;
        height: 220px;
        padding: 18px;
        border: 2px solid var(--b);
        border-radius: 14px;
        background: var(--bg);
        color: var(--t);
        font-family: "Courier New", monospace;
        font-size: 14px;
        resize: vertical;
      }
      textarea:focus {
        outline: none;
        border-color: var(--p);
        box-shadow: 0 0 0 5px rgba(102, 126, 234, 0.2);
      }
      .stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 18px;
        margin: 25px 0;
      }
      .stat {
        background: var(--sub);
        padding: 25px;
        border-radius: 16px;
        text-align: center;
        border: 2px solid var(--b);
        transition: 0.3s;
      }
      .stat:hover {
        border-color: var(--p);
        transform: translateY(-6px);
      }
      .num {
        font-size: 38px;
        font-weight: 900;
        background: linear-gradient(135deg, var(--p), var(--s));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }
      .btns {
        display: flex;
        gap: 14px;
        flex-wrap: wrap;
        margin: 25px 0;
      }
      button {
        padding: 16px 32px;
        font-weight: 700;
        color: #fff;
        border: none;
        border-radius: 14px;
        cursor: pointer;
        font-size: 16px;
        transition: 0.3s;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
      }
      button:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      }
      .b1 {
        background: linear-gradient(135deg, var(--p), var(--s));
      }
      .b2 {
        background: #ef4444;
      }
      .b3 {
        background: #10b981;
      }
      .b4 {
        background: #8b5cf6;
      }
      .b5 {
        background: #f59e0b;
      }
      .oneclick {
        background: #ff006e;
        font-size: 20px;
        padding: 20px 50px !important;
      }
      .warn {
        background: #ff006e;
        color: #fff;
        padding: 20px;
        border-radius: 14px;
        text-align: center;
        font-size: 18px;
        font-weight: 900;
        margin: 20px 0;
        display: none;
        animation: flash 1s infinite;
      }
      @keyframes flash {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.7;
        }
      }
      .res {
        background: var(--sub);
        border-radius: 14px;
        padding: 25px;
        margin-top: 25px;
        display: none;
        border-left: 6px solid var(--p);
      }
      .res.show {
        display: block;
      }
      .item {
        background: rgba(239, 68, 68, 0.15);
        border-left: 4px solid #ef4444;
        padding: 14px;
        margin: 10px 0;
        border-radius: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .copy {
        background: var(--p);
        padding: 8px 16px;
        border-radius: 8px;
      }
      .noti {
        position: fixed;
        top: 20px;
        right: 20px;
        background: var(--bg);
        padding: 18px 30px;
        border-radius: 14px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
        z-index: 9999;
        display: none;
        border-left: 6px solid var(--ok);
        font-weight: 700;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <button
          class="toggle"
          onclick="document.body.classList.toggle('dark-mode')"
        >
          Dark Mode
        </button>
        <div class="v">v10.2 FINAL</div>
        <h1>Traffic90 Ultimate Tool</h1>
        <p>Phát hiện trùng 100% – Không bỏ sót dù là link l.fb.com</p>
      </div>

      <div style="padding: 30px">
        <textarea
          id="input"
          placeholder="Dán link comment hoặc ID vào đây..."
        ></textarea>

        <div class="stats">
          <div class="stat">
            <div class="num" id="tong">0</div>
            <div>Tổng dòng</div>
          </div>
          <div class="stat">
            <div class="num" id="sach">0</div>
            <div>ID sạch</div>
          </div>
          <div class="stat">
            <div class="num" id="trung">0</div>
            <div>Bị trùng</div>
          </div>
          <div class="stat">
            <div class="num" id="percent">0%</div>
            <div>Tỷ lệ trùng</div>
          </div>
        </div>

        <div class="btns">
          <button class="b1" onclick="check()">KIỂM TRA TRÙNG</button>
          <button class="b2" onclick="xoaTrung()">XÓA TRÙNG NGAY</button>
          <button class="b3 oneclick" onclick="copySach()">
            XÓA TRÙNG + COPY SẠCH 1 CLICK
          </button>
          <button class="b4" onclick="copyID()">COPY CHỈ ID SẠCH</button>
          <button class="b5" onclick="clearAll()">CLEAR ALL</button>
        </div>

        <div id="warning" class="warn"></div>
        <div id="result" class="res"></div>
      </div>
    </div>

    <div id="noti" class="noti"><span id="notitext"></span></div>

    <script>
      // Regex siêu mạnh – bắt hết mọi loại link Facebook 2025
      function getID(line) {
        let m = line.match(/comment_id[=\/](\d{10,})/i);
        if (m) return m[1];
        m = line.match(/c\[0\]=(\d+_\d+)/);
        if (m) return m[1].split("_")[1];
        m = line.match(/(\d{13,20})/g);
        if (m && m[0].length >= 13) return m[0];
        return line.trim();
      }

      function check() {
        const txt = document.getElementById("input").value.trim();
        if (!txt) return noti("Dán dữ liệu đi bro!", 1);

        const lines = txt
          .split("\n")
          .map((l) => l.trim())
          .filter(Boolean);
        const seen = new Map();
        const dup = new Map();

        lines.forEach((line, i) => {
          const id = getID(line);
          if (seen.has(id)) {
            dup.set(id, (dup.get(id) || 1) + 1);
          } else {
            seen.set(id, line);
          }
        });

        const total = lines.length;
        const trung = lines.length - seen.size;
        const percent = total ? Math.round((trung / total) * 100) : 0;

        document.getElementById("tong").textContent = total;
        document.getElementById("sach").textContent = seen.size;
        document.getElementById("trung").textContent = trung;
        document.getElementById("percent").textContent = percent + "%";

        let html = trung
          ? `<div style="color:#ef4444;font-size:22px;font-weight:900">CẢNH BÁO: Phát hiện ${trung} dòng trùng!</div>`
          : `<div style="color:#10b981;font-size:22px;font-weight:900">Tuyệt vời: 100% sạch!</div>`;

        if (trung > 0) {
          html += `<div style="margin-top:15px;max-height:500px;overflow:auto">`;
          dup.forEach((count, id) => {
            if (count > 1) {
              const style = count >= 5 ? "background:#8b0000;color:#fff" : "";
              html += `<div class="item" style="${style}">
          <div>ID: <strong>${id}</strong> → xuất hiện <strong>${count}</strong> lần</div>
          <button class="copy" onclick="copy('${id}')">Copy ID</button>
        </div>`;
            }
          });
          html += `</div>`;
          document.getElementById("warning").style.display = "block";
          document.getElementById(
            "warning"
          ).textContent = `⚠️ TRÙNG NẶNG: ${trung} dòng – KHÔNG NÊN UP!`;
        } else {
          document.getElementById("warning").style.display = "none";
        }

        document.getElementById("result").innerHTML = html;
        document.getElementById("result").classList.add("show");
        noti(
          trung ? `Phát hiện ${trung} trùng!` : "List sạch 100%!",
          trung ? 1 : 0
        );
      }

      function xoaTrung() {
        const lines = document.getElementById("input").value.split("\n");
        const seen = new Set();
        const clean = [];
        lines.forEach((l) => {
          const id = getID(l);
          if (!seen.has(id)) {
            seen.add(id);
            clean.push(l.trim());
          }
        });
        document.getElementById("input").value = clean.join("\n");
        noti(`ĐÃ XÓA TRÙNG! Còn lại ${clean.length} dòng`, 0);
        check();
      }

      function copySach() {
        xoaTrung();
        setTimeout(() => {
          const clean = document.getElementById("input").value;
          navigator.clipboard.writeText(clean);
          noti(
            `ĐÃ COPY ${clean.split("\n").filter(Boolean).length} DÒNG SẠCH!`,
            0
          );
        }, 300);
      }

      function copyID() {
        const lines = document.getElementById("input").value.split("\n");
        const ids = lines.map((l) => getID(l)).filter(Boolean);
        const uniq = [...new Set(ids)].join("\n");
        navigator.clipboard.writeText(uniq);
        noti(`ĐÃ COPY ${uniq.split("\n").length} ID DUY NHẤT!`, 0);
      }

      function clearAll() {
        document.getElementById("input").value = "";
        document.getElementById("result").classList.remove("show");
        document.getElementById("warning").style.display = "none";
        ["tong", "sach", "trung", "percent"].forEach(
          (x) => (document.getElementById(x).textContent = "0")
        );
      }

      function copy(t) {
        navigator.clipboard.writeText(t);
        noti("Copied ID!");
      }

      function noti(msg, error = 0) {
        const n = document.getElementById("noti");
        document.getElementById("notitext").textContent = msg;
        n.style.borderLeftColor = error ? "#ef4444" : "#10b981";
        n.style.display = "block";
        setTimeout(() => (n.style.display = "none"), 3000);
      }

      // Auto check khi dán
      document
        .getElementById("input")
        .addEventListener("paste", () => setTimeout(check, 200));
    </script>
  </body>
</html>
