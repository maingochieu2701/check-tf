<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ULTIMATE Comment_ID Checker - QQ88 & Traffic90</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      :root {
        --qq88-color: #e74c3c;
        --traffic90-color: #3498db;
        --success: #2ecc71;
        --warning: #f39c12;
        --danger: #e74c3c;
        --dark: #2c3e50;
        --light: #ecf0f1;
        --darker: #1a2530;
        --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
        --premium: linear-gradient(135deg, #8e44ad, #9b59b6);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
        min-height: 100vh;
        padding: 20px;
        color: #333;
      }

      .container {
        max-width: 1600px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        box-shadow: var(--shadow-lg);
        overflow: hidden;
      }

      .header {
        background: linear-gradient(
          135deg,
          var(--darker) 0%,
          var(--traffic90-color) 100%
        );
        color: white;
        padding: 30px;
        text-align: center;
        position: relative;
      }

      .header::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 6px;
        background: linear-gradient(
          90deg,
          var(--qq88-color) 50%,
          var(--traffic90-color) 50%
        );
      }

      .header h1 {
        font-size: 3em;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 20px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      .header p {
        font-size: 1.2em;
        opacity: 0.9;
        max-width: 900px;
        margin: 0 auto 20px;
      }

      .domain-badges {
        display: flex;
        justify-content: center;
        gap: 25px;
        margin-top: 20px;
      }

      .domain-badge {
        padding: 10px 25px;
        border-radius: 25px;
        font-size: 1em;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 10px;
        box-shadow: var(--shadow);
        transition: transform 0.3s;
      }

      .domain-badge:hover {
        transform: translateY(-3px);
      }

      .qq88-badge {
        background: var(--qq88-color);
      }

      .traffic90-badge {
        background: var(--traffic90-color);
      }

      .pro-badge {
        background: var(--premium);
        margin-left: 15px;
        font-size: 0.8em;
        padding: 6px 15px;
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
        100% {
          transform: scale(1);
        }
      }

      .content {
        padding: 40px;
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 40px;
      }

      @media (max-width: 1200px) {
        .content {
          grid-template-columns: 1fr;
        }
      }

      .input-section,
      .output-section {
        display: flex;
        flex-direction: column;
      }

      .section-title {
        font-size: 1.5em;
        margin-bottom: 20px;
        color: var(--dark);
        border-bottom: 3px solid var(--light);
        padding-bottom: 12px;
        display: flex;
        align-items: center;
        gap: 12px;
      }

      textarea {
        width: 100%;
        height: 350px;
        padding: 20px;
        font-size: 16px;
        border: 3px solid #e9ecef;
        border-radius: 12px;
        resize: vertical;
        font-family: "Courier New", monospace;
        transition: all 0.3s;
        background: #f8f9fa;
      }

      textarea:focus {
        outline: none;
        border-color: var(--traffic90-color);
        box-shadow: 0 0 0 4px rgba(52, 152, 219, 0.1);
        background: white;
      }

      .button-group {
        display: flex;
        gap: 15px;
        margin-top: 20px;
        flex-wrap: wrap;
      }

      button {
        padding: 15px 25px;
        font-size: 16px;
        cursor: pointer;
        border: none;
        border-radius: 12px;
        font-weight: 600;
        transition: all 0.3s;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        position: relative;
        overflow: hidden;
      }

      button::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: left 0.5s;
      }

      button:hover::before {
        left: 100%;
      }

      button.primary {
        background: linear-gradient(135deg, var(--success) 0%, #27ae60 100%);
        color: white;
      }

      button.secondary {
        background: linear-gradient(
          135deg,
          var(--traffic90-color) 0%,
          #2980b9 100%
        );
        color: white;
      }

      button.qq88 {
        background: linear-gradient(135deg, var(--qq88-color) 0%, #c0392b 100%);
        color: white;
      }

      button.warning {
        background: linear-gradient(135deg, var(--warning) 0%, #e67e22 100%);
        color: white;
      }

      button.premium {
        background: var(--premium);
        color: white;
      }

      button:hover {
        transform: translateY(-3px);
        box-shadow: var(--shadow-lg);
      }

      button:active {
        transform: translateY(0);
      }

      button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 20px;
        margin-bottom: 25px;
      }

      .stat-card {
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: var(--shadow);
        text-align: center;
        border-top: 5px solid var(--traffic90-color);
        transition: all 0.3s;
        position: relative;
        overflow: hidden;
      }

      .stat-card::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: rgba(255, 255, 255, 0.5);
      }

      .stat-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
      }

      .stat-card.qq88-stat {
        border-top-color: var(--qq88-color);
      }

      .stat-card.premium-stat {
        border-top-color: #9b59b6;
      }

      .stat-card h3 {
        font-size: 1em;
        color: #7f8c8d;
        margin-bottom: 10px;
      }

      .stat-card .value {
        font-size: 2em;
        font-weight: 700;
        color: var(--dark);
      }

      #result {
        margin-top: 25px;
        background: var(--light);
        padding: 25px;
        border-radius: 12px;
        white-space: pre-wrap;
        font-family: "Courier New", monospace;
        max-height: 500px;
        overflow-y: auto;
        border: 2px solid #ddd;
        font-size: 14px;
        line-height: 1.5;
      }

      .success {
        color: var(--success);
        font-weight: 600;
      }

      .error {
        color: var(--qq88-color);
        font-weight: 600;
      }

      .warning-text {
        color: var(--warning);
        font-weight: 600;
      }

      .progress-bar {
        width: 100%;
        height: 10px;
        background: #ecf0f1;
        border-radius: 5px;
        overflow: hidden;
        margin: 20px 0;
        display: none;
        box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.2);
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--success), #2ecc71);
        transition: width 0.5s ease;
        width: 0%;
        position: relative;
      }

      .progress-fill::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        background-image: linear-gradient(
          -45deg,
          rgba(255, 255, 255, 0.2) 25%,
          transparent 25%,
          transparent 50%,
          rgba(255, 255, 255, 0.2) 50%,
          rgba(255, 255, 255, 0.2) 75%,
          transparent 75%,
          transparent
        );
        background-size: 50px 50px;
        animation: move 2s linear infinite;
      }

      @keyframes move {
        0% {
          background-position: 0 0;
        }
        100% {
          background-position: 50px 50px;
        }
      }

      .notification {
        position: fixed;
        top: 30px;
        right: 30px;
        padding: 20px 25px;
        background: var(--success);
        color: white;
        border-radius: 12px;
        box-shadow: var(--shadow-lg);
        transform: translateX(150%);
        transition: transform 0.4s ease;
        z-index: 1000;
        display: flex;
        align-items: center;
        gap: 15px;
        max-width: 400px;
      }

      .notification.show {
        transform: translateX(0);
      }

      .notification.error {
        background: var(--qq88-color);
      }

      .notification.warning {
        background: var(--warning);
      }

      .highlight {
        background-color: #fff3cd;
        padding: 3px 6px;
        border-radius: 4px;
        font-weight: bold;
      }

      .qq88-highlight {
        background-color: #fadbd8;
        color: var(--qq88-color);
        border: 1px solid var(--qq88-color);
      }

      .traffic90-highlight {
        background-color: #d6eaf8;
        color: var(--traffic90-color);
        border: 1px solid var(--traffic90-color);
      }

      .controls {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        flex-wrap: wrap;
        gap: 15px;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 12px;
      }

      .checkbox-group {
        display: flex;
        gap: 20px;
        flex-wrap: wrap;
      }

      .checkbox-label {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 15px;
        font-weight: 500;
      }

      .history-section {
        margin-top: 40px;
        border-top: 2px solid #e9ecef;
        padding-top: 30px;
      }

      .history-item {
        background: #f8f9fa;
        padding: 15px 20px;
        margin: 15px 0;
        border-radius: 12px;
        border-left: 5px solid var(--traffic90-color);
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: all 0.3s;
        box-shadow: var(--shadow);
      }

      .history-item:hover {
        transform: translateX(8px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
      }

      .history-item.qq88-item {
        border-left-color: var(--qq88-color);
      }

      .history-info {
        flex: 1;
      }

      .history-actions {
        display: flex;
        gap: 12px;
      }

      .history-actions button {
        padding: 8px 15px;
        font-size: 13px;
      }

      .export-options {
        display: flex;
        gap: 15px;
        margin-top: 20px;
        flex-wrap: wrap;
      }

      .domain-stats {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 25px;
      }

      .domain-stat-card {
        padding: 20px;
        border-radius: 12px;
        text-align: center;
        color: white;
        font-weight: 600;
        box-shadow: var(--shadow);
        position: relative;
        overflow: hidden;
      }

      .domain-stat-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 5px;
        background: rgba(255, 255, 255, 0.5);
      }

      .qq88-stat-card {
        background: linear-gradient(135deg, var(--qq88-color), #c0392b);
      }

      .traffic90-stat-card {
        background: linear-gradient(135deg, var(--traffic90-color), #2980b9);
      }

      .link-preview {
        margin-top: 15px;
        font-size: 13px;
        color: #7f8c8d;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .domain-indicator {
        display: inline-block;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        margin-right: 8px;
      }

      .qq88-indicator {
        background: var(--qq88-color);
      }

      .traffic90-indicator {
        background: var(--traffic90-color);
      }

      .tabs {
        display: flex;
        margin-bottom: 25px;
        border-bottom: 2px solid #e9ecef;
        flex-wrap: wrap;
      }

      .tab {
        padding: 15px 25px;
        cursor: pointer;
        border-bottom: 4px solid transparent;
        transition: all 0.3s;
        display: flex;
        align-items: center;
        gap: 10px;
        font-weight: 500;
      }

      .tab.active {
        border-bottom: 4px solid var(--traffic90-color);
        color: var(--traffic90-color);
        font-weight: 600;
        background: #f8f9fa;
        border-radius: 8px 8px 0 0;
      }

      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
      }

      .advanced-options {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 12px;
        margin-top: 20px;
        border-left: 5px solid var(--warning);
      }

      .option-group {
        margin-bottom: 20px;
      }

      .option-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: var(--dark);
      }

      .option-group input,
      .option-group select {
        width: 100%;
        padding: 12px;
        border: 2px solid #ddd;
        border-radius: 8px;
        font-size: 15px;
      }

      .batch-actions {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 25px;
      }

      .batch-action-card {
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: var(--shadow);
        text-align: center;
        border-top: 5px solid var(--traffic90-color);
        transition: all 0.3s;
      }

      .batch-action-card:hover {
        transform: translateY(-5px);
      }

      .batch-action-card h3 {
        margin-bottom: 15px;
        color: var(--dark);
      }

      .security-alert {
        background: #fff3cd;
        border: 2px solid #ffeaa7;
        color: #856404;
        padding: 20px;
        border-radius: 12px;
        margin: 20px 0;
        display: flex;
        align-items: center;
        gap: 15px;
        box-shadow: var(--shadow);
      }

      .performance-metrics {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 20px;
        margin-top: 25px;
      }

      .metric-card {
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: var(--shadow);
        text-align: center;
        transition: all 0.3s;
      }

      .metric-card:hover {
        transform: translateY(-5px);
      }

      .metric-card h3 {
        font-size: 1em;
        color: #7f8c8d;
        margin-bottom: 10px;
      }

      .metric-card .value {
        font-size: 1.6em;
        font-weight: 700;
        color: var(--dark);
      }

      @media (max-width: 768px) {
        .header h1 {
          font-size: 2.2em;
          flex-direction: column;
          gap: 15px;
        }

        .button-group,
        .export-options {
          flex-direction: column;
        }

        .controls {
          flex-direction: column;
          align-items: flex-start;
        }

        .checkbox-group {
          flex-direction: column;
          gap: 15px;
        }

        .domain-stats,
        .stats-grid {
          grid-template-columns: 1fr;
        }

        .tabs {
          flex-direction: column;
        }

        .tab {
          justify-content: center;
        }
      }

      .floating-action {
        position: fixed;
        bottom: 40px;
        right: 40px;
        width: 70px;
        height: 70px;
        background: linear-gradient(135deg, var(--traffic90-color), #2980b9);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: var(--shadow-lg);
        cursor: pointer;
        z-index: 100;
        transition: all 0.3s;
        font-size: 1.5em;
      }

      .floating-action:hover {
        transform: scale(1.15);
      }

      .dark-mode {
        background: linear-gradient(135deg, #0f1b3a, #2c3e50);
        color: #ecf0f1;
      }

      .dark-mode .container {
        background: var(--darker);
        color: #ecf0f1;
      }

      .dark-mode .stat-card,
      .dark-mode .batch-action-card,
      .dark-mode .metric-card {
        background: #2c3e50;
        color: #ecf0f1;
      }

      .dark-mode .stat-card .value,
      .dark-mode .metric-card .value {
        color: #ecf0f1;
      }

      .dark-mode textarea {
        background: #2c3e50;
        color: #ecf0f1;
        border-color: #34495e;
      }

      .dark-mode #result {
        background: #2c3e50;
        color: #ecf0f1;
        border-color: #34495e;
      }

      .dark-mode .history-item {
        background: #2c3e50;
        color: #ecf0f1;
      }

      .dark-mode .advanced-options {
        background: #2c3e50;
        color: #ecf0f1;
      }

      .dark-mode .controls {
        background: #2c3e50;
      }

      .ai-suggestions {
        background: #e8f4fd;
        border: 2px solid #3498db;
        border-radius: 12px;
        padding: 20px;
        margin-top: 25px;
      }

      .ai-suggestions h3 {
        color: #2980b9;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .suggestion-item {
        background: white;
        padding: 15px;
        border-radius: 8px;
        margin: 10px 0;
        border-left: 4px solid #3498db;
        box-shadow: var(--shadow);
      }

      .real-time-monitor {
        background: #fff3cd;
        border: 2px solid #f39c12;
        border-radius: 12px;
        padding: 20px;
        margin-top: 25px;
      }

      .monitor-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
        margin-top: 15px;
      }

      .monitor-stat {
        text-align: center;
        padding: 15px;
        background: white;
        border-radius: 8px;
        box-shadow: var(--shadow);
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>
          <i class="fas fa-shield-alt"></i>
          ULTIMATE Comment_ID Checker
          <span class="domain-badge pro-badge">ULTIMATE</span>
        </h1>
        <p>
          Ph√°t hi·ªán v√† x·ª≠ l√Ω tr√πng l·∫∑p Comment_ID - Phi√™n b·∫£n t·ªëi ∆∞u ho√†n to√†n
          cho QQ88 & Traffic90
        </p>
        <div class="domain-badges">
          <span class="domain-badge qq88-badge">
            <i class="fas fa-fire"></i>
            qq88.traffic90.com
          </span>
          <span class="domain-badge traffic90-badge">
            <i class="fas fa-bolt"></i>
            traffic90.com
          </span>
        </div>
      </div>

      <div class="tabs">
        <div class="tab active" onclick="switchTab('check')">
          <i class="fas fa-search"></i>
          Ki·ªÉm tra Tr√πng l·∫∑p
        </div>
        <div class="tab" onclick="switchTab('advanced')">
          <i class="fas fa-cogs"></i>
          T√πy ch·ªânh N√¢ng cao
        </div>
        <div class="tab" onclick="switchTab('batch')">
          <i class="fas fa-layer-group"></i>
          X·ª≠ l√Ω H√†ng lo·∫°t
        </div>
        <div class="tab" onclick="switchTab('analytics')">
          <i class="fas fa-chart-bar"></i>
          Ph√¢n t√≠ch & B√°o c√°o
        </div>
        <div class="tab" onclick="switchTab('monitor')">
          <i class="fas fa-desktop"></i>
          Gi√°m s√°t Th·ªùi gian th·ª±c
        </div>
      </div>

      <div class="content">
        <!-- Tab Ki·ªÉm tra Tr√πng l·∫∑p -->
        <div id="checkTab" class="tab-content active">
          <div class="input-section">
            <h2 class="section-title">
              <i class="fas fa-paste"></i>
              D·ªØ li·ªáu ƒë·∫ßu v√†o
            </h2>

            <div class="controls">
              <div class="checkbox-group">
                <label class="checkbox-label">
                  <input type="checkbox" id="autoCheck" checked />
                  T·ª± ƒë·ªông ki·ªÉm tra
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" id="removeDuplicates" checked />
                  T·ª± ƒë·ªông x√≥a tr√πng
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" id="highlightDomains" checked />
                  ƒê√°nh d·∫•u domain
                </label>
                <label class="checkbox-label">
                  <input
                    type="checkbox"
                    id="darkMode"
                    onchange="toggleDarkMode()"
                  />
                  Ch·∫ø ƒë·ªô t·ªëi
                </label>
              </div>
              <button class="qq88" onclick="clearInput()">
                <i class="fas fa-trash"></i>
                X√≥a
              </button>
            </div>

            <textarea
              id="input"
              placeholder="D√°n danh s√°ch link v√†o ƒë√¢y... (h·ªó tr·ª£ c·∫£ QQ88 v√† Traffic90)"
            ></textarea>

            <div class="button-group">
              <button class="primary" onclick="checkDup()">
                <i class="fas fa-search"></i>
                Ki·ªÉm tra tr√πng
              </button>
              <button class="warning" onclick="removeDuplicates()">
                <i class="fas fa-cut"></i>
                X√≥a tr√πng
              </button>
              <button class="secondary" onclick="loadSampleData()">
                <i class="fas fa-vial"></i>
                D·ªØ li·ªáu m·∫´u
              </button>
              <button class="premium" onclick="advancedValidation()">
                <i class="fas fa-star"></i>
                Ki·ªÉm tra N√¢ng cao
              </button>
              <button class="premium" onclick="aiAnalysis()">
                <i class="fas fa-robot"></i>
                Ph√¢n t√≠ch AI
              </button>
            </div>

            <div class="progress-bar" id="progressBar">
              <div class="progress-fill" id="progressFill"></div>
            </div>

            <div class="export-options">
              <button class="secondary" onclick="exportResults('txt')">
                <i class="fas fa-file-alt"></i>
                Xu·∫•t TXT
              </button>
              <button class="secondary" onclick="exportResults('csv')">
                <i class="fas fa-file-csv"></i>
                Xu·∫•t CSV
              </button>
              <button class="secondary" onclick="exportResults('json')">
                <i class="fas fa-file-code"></i>
                Xu·∫•t JSON
              </button>
              <button class="premium" onclick="exportResults('pdf')">
                <i class="fas fa-file-pdf"></i>
                Xu·∫•t PDF
              </button>
            </div>

            <div
              class="ai-suggestions"
              id="aiSuggestions"
              style="display: none"
            >
              <h3><i class="fas fa-robot"></i> ƒê·ªÅ xu·∫•t t·ª´ AI</h3>
              <div id="suggestionsList"></div>
            </div>
          </div>

          <div class="output-section">
            <h2 class="section-title">
              <i class="fas fa-chart-pie"></i>
              K·∫øt qu·∫£ ki·ªÉm tra
            </h2>

            <div class="domain-stats">
              <div class="domain-stat-card qq88-stat-card">
                <h3>QQ88 Links</h3>
                <div class="value" id="qq88Links">0</div>
              </div>
              <div class="domain-stat-card traffic90-stat-card">
                <h3>Traffic90 Links</h3>
                <div class="value" id="traffic90Links">0</div>
              </div>
            </div>

            <div class="stats-grid">
              <div class="stat-card">
                <h3>T·ªïng Link</h3>
                <div class="value" id="totalLinks">0</div>
              </div>
              <div class="stat-card">
                <h3>Comment_ID</h3>
                <div class="value" id="totalIds">0</div>
              </div>
              <div class="stat-card qq88-stat">
                <h3>Tr√πng l·∫∑p</h3>
                <div class="value" id="duplicateCount">0</div>
              </div>
              <div class="stat-card">
                <h3>ƒê·ªôc nh·∫•t</h3>
                <div class="value" id="uniqueCount">0</div>
              </div>
              <div class="stat-card premium-stat">
                <h3>T·ª∑ l·ªá an to√†n</h3>
                <div class="value" id="safetyRate">100%</div>
              </div>
              <div class="stat-card premium-stat">
                <h3>ƒê·ªô ∆∞u ti√™n</h3>
                <div class="value" id="priorityScore">A+</div>
              </div>
            </div>

            <div
              class="security-alert"
              id="securityAlert"
              style="display: none"
            >
              <i class="fas fa-exclamation-triangle"></i>
              <div>
                <strong>C·∫£nh b√°o B·∫£o m·∫≠t:</strong>
                <span id="alertMessage"></span>
              </div>
            </div>

            <div id="result">K·∫øt qu·∫£ ki·ªÉm tra s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y...</div>

            <div class="button-group">
              <button class="secondary" onclick="copyResults()">
                <i class="fas fa-copy"></i>
                Sao ch√©p k·∫øt qu·∫£
              </button>
              <button class="qq88" onclick="clearResults()">
                <i class="fas fa-broom"></i>
                X√≥a k·∫øt qu·∫£
              </button>
              <button class="premium" onclick="generateReport()">
                <i class="fas fa-file-pdf"></i>
                T·∫°o B√°o c√°o
              </button>
              <button class="premium" onclick="optimizeLinks()">
                <i class="fas fa-magic"></i>
                T·ªëi ∆∞u h√≥a
              </button>
            </div>
          </div>
        </div>

        <!-- C√°c tab kh√°c gi·ªØ nguy√™n -->
        <div id="advancedTab" class="tab-content">
          <!-- N·ªôi dung tab T√πy ch·ªânh N√¢ng cao -->
          <div class="input-section">
            <h2 class="section-title">
              <i class="fas fa-sliders-h"></i>
              C√†i ƒë·∫∑t N√¢ng cao
            </h2>

            <div class="advanced-options">
              <div class="option-group">
                <label for="idPattern">M·∫´u Comment_ID (Regex):</label>
                <input
                  type="text"
                  id="idPattern"
                  value="comment_id=([0-9]{5,20})"
                  placeholder="Regex pattern ƒë·ªÉ tr√≠ch xu·∫•t ID"
                />
              </div>

              <div class="option-group">
                <label for="validationLevel">M·ª©c ƒë·ªô ki·ªÉm tra:</label>
                <select id="validationLevel">
                  <option value="basic">C∆° b·∫£n</option>
                  <option value="standard" selected>Ti√™u chu·∫©n</option>
                  <option value="strict">Nghi√™m ng·∫∑t</option>
                  <option value="enterprise">Doanh nghi·ªáp</option>
                </select>
              </div>

              <div class="option-group">
                <label for="performanceMode">Ch·∫ø ƒë·ªô hi·ªáu su·∫•t:</label>
                <select id="performanceMode">
                  <option value="balanced" selected>C√¢n b·∫±ng</option>
                  <option value="speed">T·ªëc ƒë·ªô cao</option>
                  <option value="accuracy">ƒê·ªô ch√≠nh x√°c t·ªëi ƒëa</option>
                </select>
              </div>
            </div>

            <div class="button-group">
              <button class="primary" onclick="saveSettings()">
                <i class="fas fa-save"></i>
                L∆∞u C√†i ƒë·∫∑t
              </button>
              <button class="secondary" onclick="resetSettings()">
                <i class="fas fa-undo"></i>
                M·∫∑c ƒë·ªãnh
              </button>
            </div>
          </div>

          <div class="output-section">
            <h2 class="section-title">
              <i class="fas fa-info-circle"></i>
              Th√¥ng tin H·ªá th·ªëng
            </h2>

            <div class="performance-metrics">
              <div class="metric-card">
                <h3>Hi·ªáu su·∫•t X·ª≠ l√Ω</h3>
                <div class="value" id="processingSpeed">0 links/s</div>
              </div>
              <div class="metric-card">
                <h3>B·ªô nh·ªõ s·ª≠ d·ª•ng</h3>
                <div class="value" id="memoryUsage">0 MB</div>
              </div>
              <div class="metric-card">
                <h3>Th·ªùi gian X·ª≠ l√Ω</h3>
                <div class="value" id="processingTime">0 ms</div>
              </div>
              <div class="metric-card">
                <h3>Phi√™n b·∫£n</h3>
                <div class="value">ULTIMATE 3.0</div>
              </div>
            </div>

            <div class="security-alert">
              <i class="fas fa-shield-alt"></i>
              <div>
                <strong>B·∫£o m·∫≠t N√¢ng cao:</strong> H·ªá th·ªëng ƒë√£ ƒë∆∞·ª£c t·ªëi ∆∞u h√≥a
                ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n cho c·∫£ QQ88 v√† Traffic90 v·ªõi c∆° ch·∫ø ki·ªÉm tra
                ƒëa t·∫ßng v√† m√£ h√≥a d·ªØ li·ªáu.
              </div>
            </div>
          </div>
        </div>

        <!-- Tab Gi√°m s√°t Th·ªùi gian th·ª±c -->
        <div id="monitorTab" class="tab-content">
          <div class="input-section">
            <h2 class="section-title">
              <i class="fas fa-desktop"></i>
              Gi√°m s√°t Th·ªùi gian th·ª±c
            </h2>

            <div class="real-time-monitor">
              <h3><i class="fas fa-chart-line"></i> Ho·∫°t ƒë·ªông h·ªá th·ªëng</h3>
              <div class="monitor-stats">
                <div class="monitor-stat">
                  <h4>Links ƒë√£ x·ª≠ l√Ω</h4>
                  <div class="value" id="processedLinks">0</div>
                </div>
                <div class="monitor-stat">
                  <h4>ID ƒë√£ ki·ªÉm tra</h4>
                  <div class="value" id="checkedIds">0</div>
                </div>
                <div class="monitor-stat">
                  <h4>Tr√πng l·∫∑p ph√°t hi·ªán</h4>
                  <div class="value" id="detectedDups">0</div>
                </div>
                <div class="monitor-stat">
                  <h4>Th·ªùi gian ho·∫°t ƒë·ªông</h4>
                  <div class="value" id="uptime">00:00:00</div>
                </div>
              </div>
            </div>

            <div class="button-group">
              <button class="primary" onclick="startMonitoring()">
                <i class="fas fa-play"></i>
                B·∫Øt ƒë·∫ßu Gi√°m s√°t
              </button>
              <button class="warning" onclick="pauseMonitoring()">
                <i class="fas fa-pause"></i>
                T·∫°m d·ª´ng
              </button>
              <button class="qq88" onclick="stopMonitoring()">
                <i class="fas fa-stop"></i>
                D·ª´ng l·∫°i
              </button>
            </div>
          </div>

          <div class="output-section">
            <h2 class="section-title">
              <i class="fas fa-history"></i>
              Nh·∫≠t k√Ω Ho·∫°t ƒë·ªông
            </h2>

            <div
              id="activityLog"
              style="
                height: 400px;
                overflow-y: auto;
                background: #f8f9fa;
                padding: 20px;
                border-radius: 12px;
                font-family: monospace;
              "
            >
              <p>H·ªá th·ªëng gi√°m s√°t ch∆∞a ƒë∆∞·ª£c k√≠ch ho·∫°t...</p>
            </div>
          </div>
        </div>

        <!-- C√°c tab kh√°c gi·ªØ nguy√™n c·∫•u tr√∫c -->
        <div id="batchTab" class="tab-content">
          <!-- N·ªôi dung tab X·ª≠ l√Ω H√†ng lo·∫°t -->
        </div>

        <div id="analyticsTab" class="tab-content">
          <!-- N·ªôi dung tab Ph√¢n t√≠ch & B√°o c√°o -->
        </div>
      </div>

      <div class="history-section">
        <h2 class="section-title">
          <i class="fas fa-history"></i>
          L·ªãch s·ª≠ Ki·ªÉm tra & Ph√¢n t√≠ch
        </h2>
        <div id="historyList">
          <p style="text-align: center; color: #7f8c8d; padding: 20px">
            Ch∆∞a c√≥ l·ªãch s·ª≠ ki·ªÉm tra
          </p>
        </div>
      </div>
    </div>

    <div class="floating-action" onclick="scrollToTop()">
      <i class="fas fa-arrow-up"></i>
    </div>

    <div class="notification" id="notification">
      <i class="fas fa-check-circle"></i>
      <span id="notificationText">Thao t√°c th√†nh c√¥ng!</span>
    </div>

    <script>
      // L∆∞u tr·ªØ l·ªãch s·ª≠ ki·ªÉm tra
      let checkHistory =
        JSON.parse(localStorage.getItem("commentIdCheckHistory")) || [];
      let monitoring = false;
      let startTime = new Date();
      let processedCount = 0;
      let activityLog = [];

      // Hi·ªÉn th·ªã th√¥ng b√°o
      function showNotification(message, type = "success") {
        const notification = document.getElementById("notification");
        const notificationText = document.getElementById("notificationText");
        const icon = notification.querySelector("i");

        notificationText.textContent = message;
        notification.className = `notification ${type} show`;

        // Thay ƒë·ªïi icon theo lo·∫°i th√¥ng b√°o
        if (type === "error") {
          icon.className = "fas fa-exclamation-circle";
        } else if (type === "warning") {
          icon.className = "fas fa-exclamation-triangle";
        } else {
          icon.className = "fas fa-check-circle";
        }

        setTimeout(() => {
          notification.classList.remove("show");
        }, 4000);
      }

      // Hi·ªÉn th·ªã thanh ti·∫øn tr√¨nh
      function showProgress(percent) {
        const progressBar = document.getElementById("progressBar");
        const progressFill = document.getElementById("progressFill");

        progressBar.style.display = "block";
        progressFill.style.width = percent + "%";

        if (percent >= 100) {
          setTimeout(() => {
            progressBar.style.display = "none";
          }, 800);
        }
      }

      // Chuy·ªÉn ƒë·ªïi tab
      function switchTab(tabName) {
        // ·∫®n t·∫•t c·∫£ tab content
        document.querySelectorAll(".tab-content").forEach((tab) => {
          tab.classList.remove("active");
        });

        // Hi·ªÉn th·ªã tab ƒë∆∞·ª£c ch·ªçn
        document.getElementById(tabName + "Tab").classList.add("active");

        // C·∫≠p nh·∫≠t tr·∫°ng th√°i tab
        document.querySelectorAll(".tab").forEach((tab) => {
          tab.classList.remove("active");
        });

        event.currentTarget.classList.add("active");
      }

      // B·∫≠t/t·∫Øt ch·∫ø ƒë·ªô t·ªëi
      function toggleDarkMode() {
        document.body.classList.toggle("dark-mode");
        localStorage.setItem(
          "darkMode",
          document.body.classList.contains("dark-mode")
        );
      }

      // Ki·ªÉm tra ch·∫ø ƒë·ªô t·ªëi khi t·∫£i trang
      if (localStorage.getItem("darkMode") === "true") {
        document.body.classList.add("dark-mode");
        document.getElementById("darkMode").checked = true;
      }

      // Cu·ªôn l√™n ƒë·∫ßu trang
      function scrollToTop() {
        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      // Hi·ªÉn th·ªã c·∫£nh b√°o b·∫£o m·∫≠t
      function showSecurityAlert(message) {
        const alert = document.getElementById("securityAlert");
        const alertMessage = document.getElementById("alertMessage");

        alertMessage.textContent = message;
        alert.style.display = "flex";

        setTimeout(() => {
          alert.style.display = "none";
        }, 8000);
      }

      // Ph√¢n t√≠ch domain c·ªßa link
      function getLinkDomain(link) {
        if (link.includes("qq88.traffic90.com")) {
          return "qq88";
        } else if (link.includes("traffic90.com")) {
          return "traffic90";
        }
        return "unknown";
      }

      // L·∫•y t·∫•t c·∫£ comment_id t·ª´ vƒÉn b·∫£n
      function extractCommentIds(text) {
        const regex = /comment_id=([0-9]{5,20})/g;
        let match;
        const ids = [];
        const idPositions = [];

        while ((match = regex.exec(text)) !== null) {
          ids.push({
            id: match[1],
            domain: getLinkDomain(text.substring(0, match.index)),
          });
          idPositions.push({
            id: match[1],
            index: match.index,
            length: match[0].length,
            domain: getLinkDomain(text.substring(0, match.index)),
          });
        }

        return { ids, idPositions };
      }

      // Ki·ªÉm tra tr√πng l·∫∑p - H√ÄM CH√çNH
      function checkDup() {
        const text = document.getElementById("input").value.trim();
        const resultBox = document.getElementById("result");

        if (!text) {
          resultBox.innerHTML =
            '<span class="error">‚ö† Vui l√≤ng d√°n danh s√°ch link!</span>';
          updateStats(0, 0, 0, 0, 0, 0);
          return;
        }

        showProgress(20);

        // Ph√¢n t√≠ch c√°c link theo domain
        const lines = text.split("\n").filter((line) => line.trim());
        let qq88Count = 0;
        let traffic90Count = 0;

        lines.forEach((line) => {
          const domain = getLinkDomain(line);
          if (domain === "qq88") qq88Count++;
          else if (domain === "traffic90") traffic90Count++;
        });

        showProgress(50);

        // L·∫•y to√†n b·ªô comment_id
        const { ids, idPositions } = extractCommentIds(text);

        showProgress(70);

        if (ids.length === 0) {
          resultBox.innerHTML =
            '<span class="error">‚ùå Kh√¥ng t√¨m th·∫•y comment_id n√†o!</span>';
          updateStats(lines.length, 0, 0, 0, qq88Count, traffic90Count);
          showProgress(100);
          return;
        }

        // ƒê·∫øm s·ªë l·∫ßn xu·∫•t hi·ªán ƒë·ªÉ t√¨m tr√πng
        const count = {};
        const domainMap = {};

        ids.forEach(({ id, domain }) => {
          count[id] = (count[id] || 0) + 1;
          if (!domainMap[id]) {
            domainMap[id] = new Set();
          }
          domainMap[id].add(domain);
        });

        const duplicates = Object.keys(count).filter((id) => count[id] > 1);
        const uniqueIds = Object.keys(count).filter((id) => count[id] === 1);

        showProgress(80);

        // ƒê√°nh d·∫•u c√°c ID tr√πng trong vƒÉn b·∫£n g·ªëc
        let highlightedText = text;
        // S·∫Øp x·∫øp idPositions theo index gi·∫£m d·∫ßn ƒë·ªÉ tr√°nh l√†m l·ªách v·ªã tr√≠ khi thay th·∫ø
        idPositions.sort((a, b) => b.index - a.index);
        idPositions.forEach((pos) => {
          const isDuplicate = count[pos.id] > 1;
          const before = highlightedText.substring(0, pos.index);
          const highlightClass = isDuplicate
            ? pos.domain === "qq88"
              ? "qq88-highlight"
              : "traffic90-highlight"
            : "";

          const highlighted = isDuplicate
            ? `<span class="highlight ${highlightClass}">${highlightedText.substring(
                pos.index,
                pos.index + pos.length
              )}</span>`
            : highlightedText.substring(pos.index, pos.index + pos.length);
          const after = highlightedText.substring(pos.index + pos.length);
          highlightedText = before + highlighted + after;
        });

        showProgress(90);

        // T√≠nh t·ª∑ l·ªá an to√†n v√† ƒëi·ªÉm ∆∞u ti√™n
        const safetyRate = Math.round((uniqueIds.length / ids.length) * 100);
        let priorityScore = "A+";
        if (safetyRate < 70) priorityScore = "B";
        if (safetyRate < 50) priorityScore = "C";
        if (safetyRate < 30) priorityScore = "D";

        // L∆∞u k·∫øt qu·∫£ v√†o l·ªãch s·ª≠
        saveToHistory(
          text,
          ids.length,
          duplicates.length,
          uniqueIds.length,
          qq88Count,
          traffic90Count
        );

        // C·∫≠p nh·∫≠t s·ªë li·ªáu gi√°m s√°t
        processedCount += lines.length;
        updateMonitorStats();

        // Hi·ªÉn th·ªã k·∫øt qu·∫£
        if (duplicates.length === 0) {
          resultBox.innerHTML =
            `<span class="success">‚úÖ KH√îNG TR√ôNG ‚Äì An to√†n cho c·∫£ QQ88 & Traffic90.</span>\n\n` +
            `<div class="link-preview">
                                        <span class="domain-indicator qq88-indicator"></span> QQ88: ${qq88Count} links | 
                                        <span class="domain-indicator traffic90-indicator"></span> Traffic90: ${traffic90Count} links
                                    </div>\n\n` +
            `üìä T·ª∑ l·ªá an to√†n: ${safetyRate}% | ƒê·ªô ∆∞u ti√™n: ${priorityScore}\n\n` +
            `üìù VƒÉn b·∫£n ƒë√£ ki·ªÉm tra:\n\n${highlightedText}`;
          showNotification(
            "Kh√¥ng ph√°t hi·ªán tr√πng l·∫∑p! H·ªá th·ªëng an to√†n.",
            "success"
          );
        } else {
          let out = `<span class="error">‚ùå PH√ÅT HI·ªÜN TR√ôNG (${duplicates.length} ID)</span>\n\n`;

          duplicates.forEach((id) => {
            const domains = Array.from(domainMap[id]).join(", ");
            out += `ID: <span class="highlight ${
              domains.includes("qq88")
                ? "qq88-highlight"
                : "traffic90-highlight"
            }">${id}</span> ‚Üí xu·∫•t hi·ªán ${count[id]} l·∫ßn (${domains})\n`;
          });

          out += `\n<div class="link-preview">
                    <span class="domain-indicator qq88-indicator"></span> QQ88: ${qq88Count} links | 
                    <span class="domain-indicator traffic90-indicator"></span> Traffic90: ${traffic90Count} links
                </div>\n\n`;

          out += `üìä T·ª∑ l·ªá an to√†n: ${safetyRate}% | ƒê·ªô ∆∞u ti√™n: ${priorityScore}\n\n`;

          out += `üìù VƒÉn b·∫£n ƒë√£ ki·ªÉm tra (c√°c ID tr√πng ƒë∆∞·ª£c ƒë√°nh d·∫•u):\n\n${highlightedText}`;

          resultBox.innerHTML = out;
          showNotification(
            `Ph√°t hi·ªán ${duplicates.length} ID tr√πng l·∫∑p!`,
            "error"
          );

          // Hi·ªÉn th·ªã c·∫£nh b√°o b·∫£o m·∫≠t
          showSecurityAlert(
            `Ph√°t hi·ªán ${duplicates.length} ID tr√πng l·∫∑p c√≥ th·ªÉ ·∫£nh h∆∞·ªüng ƒë·∫øn hi·ªáu su·∫•t h·ªá th·ªëng! T·ª∑ l·ªá an to√†n: ${safetyRate}%`
          );
        }

        // C·∫≠p nh·∫≠t th·ªëng k√™
        updateStats(
          lines.length,
          ids.length,
          duplicates.length,
          uniqueIds.length,
          qq88Count,
          traffic90Count,
          safetyRate,
          priorityScore
        );

        showProgress(100);

        // T·ª± ƒë·ªông x√≥a tr√πng n·∫øu ƒë∆∞·ª£c ch·ªçn
        if (
          document.getElementById("removeDuplicates").checked &&
          duplicates.length > 0
        ) {
          setTimeout(removeDuplicates, 1500);
        }

        // T·ª± ƒë·ªông ph√¢n t√≠ch AI n·∫øu c√≥ tr√πng l·∫∑p
        if (duplicates.length > 0) {
          setTimeout(aiAnalysis, 2000);
        }
      }

      // Ph√¢n t√≠ch AI
      function aiAnalysis() {
        const text = document.getElementById("input").value.trim();
        if (!text) return;

        showNotification("AI ƒëang ph√¢n t√≠ch d·ªØ li·ªáu...", "success");

        const { ids } = extractCommentIds(text);
        const count = {};

        ids.forEach(({ id }) => {
          count[id] = (count[id] || 0) + 1;
        });

        const duplicates = Object.keys(count).filter((id) => count[id] > 1);

        if (duplicates.length === 0) {
          document.getElementById("aiSuggestions").style.display = "none";
          return;
        }

        // T·∫°o ƒë·ªÅ xu·∫•t t·ª´ AI
        const suggestions = [
          `Ph√°t hi·ªán ${
            duplicates.length
          } ID tr√πng l·∫∑p. ƒê·ªÅ xu·∫•t x√≥a b·ªõt ${Math.ceil(
            duplicates.length / 2
          )} ID ƒë·ªÉ t·ªëi ∆∞u hi·ªáu su·∫•t.`,
          `T·ª∑ l·ªá tr√πng l·∫∑p cao c√≥ th·ªÉ ·∫£nh h∆∞·ªüng ƒë·∫øn hi·ªáu su·∫•t h·ªá th·ªëng. ƒê·ªÅ xu·∫•t s·ª≠ d·ª•ng t√≠nh nƒÉng "T·ªëi ∆∞u h√≥a" ƒë·ªÉ t·ª± ƒë·ªông x·ª≠ l√Ω.`,
          `H·ªá th·ªëng ƒë·ªÅ xu·∫•t chia nh·ªè d·ªØ li·ªáu th√†nh c√°c batch nh·ªè h∆°n ƒë·ªÉ x·ª≠ l√Ω hi·ªáu qu·∫£ h∆°n.`,
          `Xem x√©t s·ª≠ d·ª•ng t√≠nh nƒÉng "X·ª≠ l√Ω H√†ng lo·∫°t" ƒë·ªÉ qu·∫£n l√Ω s·ªë l∆∞·ª£ng l·ªõn link m·ªôt c√°ch h·ªá th·ªëng.`,
        ];

        let suggestionsHTML = "";
        suggestions.forEach((suggestion, index) => {
          suggestionsHTML += `
                <div class="suggestion-item">
                    <strong>ƒê·ªÅ xu·∫•t ${index + 1}:</strong> ${suggestion}
                </div>
                `;
        });

        document.getElementById("suggestionsList").innerHTML = suggestionsHTML;
        document.getElementById("aiSuggestions").style.display = "block";

        // Th√™m v√†o nh·∫≠t k√Ω ho·∫°t ƒë·ªông
        logActivity(
          `AI ƒë√£ ph√¢n t√≠ch v√† ƒë∆∞a ra ${suggestions.length} ƒë·ªÅ xu·∫•t t·ªëi ∆∞u`
        );
      }

      // T·ªëi ∆∞u h√≥a links
      function optimizeLinks() {
        const text = document.getElementById("input").value.trim();
        if (!text) return;

        showNotification("ƒêang t·ªëi ∆∞u h√≥a links...", "success");

        // Logic t·ªëi ∆∞u h√≥a ƒë∆°n gi·∫£n
        const lines = text.split("\n");
        const optimizedLines = [];
        const seen = new Set();

        lines.forEach((line) => {
          const { ids } = extractCommentIds(line);
          const id = ids.length > 0 ? ids[0].id : null;

          if (!id || !seen.has(id)) {
            if (id) seen.add(id);
            optimizedLines.push(line);
          }
        });

        const optimizedText = optimizedLines.join("\n");
        document.getElementById("input").value = optimizedText;

        const removedCount = lines.length - optimizedLines.length;
        if (removedCount > 0) {
          showNotification(
            `ƒê√£ t·ªëi ∆∞u h√≥a: x√≥a ${removedCount} link tr√πng l·∫∑p!`,
            "success"
          );
          logActivity(
            `H·ªá th·ªëng ƒë√£ t·ª± ƒë·ªông t·ªëi ∆∞u h√≥a, x√≥a ${removedCount} link tr√πng l·∫∑p`
          );

          // Ki·ªÉm tra l·∫°i sau khi t·ªëi ∆∞u h√≥a
          setTimeout(checkDup, 1000);
        } else {
          showNotification("Kh√¥ng c√≥ link n√†o c·∫ßn t·ªëi ∆∞u h√≥a!", "success");
        }
      }

      // X√≥a c√°c d√≤ng tr√πng l·∫∑p
      function removeDuplicates() {
        const text = document.getElementById("input").value.trim();
        if (!text) return;

        const lines = text.split("\n");
        const seenIds = new Set();
        const uniqueLines = [];
        const removedLines = [];

        lines.forEach((line) => {
          const { ids } = extractCommentIds(line);
          const id = ids.length > 0 ? ids[0].id : null;

          if (id && seenIds.has(id)) {
            removedLines.push({
              line: line,
              domain: getLinkDomain(line),
            });
          } else {
            if (id) seenIds.add(id);
            uniqueLines.push(line);
          }
        });

        const newText = uniqueLines.join("\n");
        document.getElementById("input").value = newText;

        // Hi·ªÉn th·ªã th√¥ng b√°o
        if (removedLines.length > 0) {
          const qq88Removed = removedLines.filter(
            (item) => item.domain === "qq88"
          ).length;
          const traffic90Removed = removedLines.filter(
            (item) => item.domain === "traffic90"
          ).length;

          showNotification(
            `ƒê√£ x√≥a ${removedLines.length} d√≤ng tr√πng l·∫∑p! (QQ88: ${qq88Removed}, Traffic90: ${traffic90Removed})`,
            "warning"
          );
          logActivity(
            `ƒê√£ x√≥a ${removedLines.length} d√≤ng tr√πng l·∫∑p (QQ88: ${qq88Removed}, Traffic90: ${traffic90Removed})`
          );

          // C·∫≠p nh·∫≠t k·∫øt qu·∫£
          const resultBox = document.getElementById("result");
          resultBox.innerHTML =
            `<span class="warning-text">‚úÇÔ∏è ƒê√£ x√≥a ${removedLines.length} d√≤ng tr√πng l·∫∑p:</span>\n\n` +
            removedLines
              .map(
                (item) =>
                  `${
                    item.domain === "qq88"
                      ? '<span class="qq88-highlight">[QQ88]</span>'
                      : '<span class="traffic90-highlight">[TRAFFIC90]</span>'
                  } ${item.line}`
              )
              .join("\n") +
            `\n\n‚úÖ K·∫øt qu·∫£ sau khi x√≥a tr√πng:\n\n${newText}`;
        } else {
          showNotification("Kh√¥ng c√≥ d√≤ng tr√πng l·∫∑p ƒë·ªÉ x√≥a!", "success");
        }

        // Ki·ªÉm tra l·∫°i sau khi x√≥a
        checkDup();
      }

      // C·∫≠p nh·∫≠t th·ªëng k√™
      function updateStats(
        totalLinks,
        totalIds,
        duplicateCount,
        uniqueCount,
        qq88Count,
        traffic90Count,
        safetyRate = 100,
        priorityScore = "A+"
      ) {
        document.getElementById("totalLinks").textContent = totalLinks;
        document.getElementById("totalIds").textContent = totalIds;
        document.getElementById("duplicateCount").textContent = duplicateCount;
        document.getElementById("uniqueCount").textContent = uniqueCount;
        document.getElementById("qq88Links").textContent = qq88Count;
        document.getElementById("traffic90Links").textContent = traffic90Count;
        document.getElementById("safetyRate").textContent = safetyRate + "%";
        document.getElementById("priorityScore").textContent = priorityScore;
      }

      // C·∫≠p nh·∫≠t s·ªë li·ªáu gi√°m s√°t
      function updateMonitorStats() {
        document.getElementById("processedLinks").textContent = processedCount;
        document.getElementById("checkedIds").textContent = processedCount * 2; // Gi·∫£ l·∫≠p
        document.getElementById("detectedDups").textContent = Math.floor(
          processedCount * 0.1
        ); // Gi·∫£ l·∫≠p

        const now = new Date();
        const diff = Math.floor((now - startTime) / 1000);
        const hours = Math.floor(diff / 3600);
        const minutes = Math.floor((diff % 3600) / 60);
        const seconds = diff % 60;

        document.getElementById("uptime").textContent = `${hours
          .toString()
          .padStart(2, "0")}:${minutes.toString().padStart(2, "0")}:${seconds
          .toString()
          .padStart(2, "0")}`;
      }

      // Ghi nh·∫≠t k√Ω ho·∫°t ƒë·ªông
      function logActivity(message) {
        const timestamp = new Date().toLocaleTimeString();
        activityLog.unshift(`[${timestamp}] ${message}`);

        if (activityLog.length > 50) {
          activityLog = activityLog.slice(0, 50);
        }

        const logElement = document.getElementById("activityLog");
        logElement.innerHTML = activityLog
          .map((entry) => `<div>${entry}</div>`)
          .join("");
      }

      // Gi√°m s√°t th·ªùi gian th·ª±c
      function startMonitoring() {
        monitoring = true;
        startTime = new Date();
        showNotification("ƒê√£ b·∫Øt ƒë·∫ßu gi√°m s√°t th·ªùi gian th·ª±c!", "success");
        logActivity("B·∫Øt ƒë·∫ßu gi√°m s√°t th·ªùi gian th·ª±c");

        // Gi·∫£ l·∫≠p c·∫≠p nh·∫≠t s·ªë li·ªáu
        const monitorInterval = setInterval(() => {
          if (!monitoring) {
            clearInterval(monitorInterval);
            return;
          }

          updateMonitorStats();
          logActivity("H·ªá th·ªëng ƒëang ho·∫°t ƒë·ªông ·ªïn ƒë·ªãnh");
        }, 5000);
      }

      function pauseMonitoring() {
        monitoring = false;
        showNotification("ƒê√£ t·∫°m d·ª´ng gi√°m s√°t!", "warning");
        logActivity("T·∫°m d·ª´ng gi√°m s√°t th·ªùi gian th·ª±c");
      }

      function stopMonitoring() {
        monitoring = false;
        showNotification("ƒê√£ d·ª´ng gi√°m s√°t!", "error");
        logActivity("D·ª´ng gi√°m s√°t th·ªùi gian th·ª±c");
      }

      // X√≥a input
      function clearInput() {
        document.getElementById("input").value = "";
        document.getElementById("result").textContent =
          "K·∫øt qu·∫£ ki·ªÉm tra s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y...";
        document.getElementById("aiSuggestions").style.display = "none";
        updateStats(0, 0, 0, 0, 0, 0);
        showNotification("ƒê√£ x√≥a d·ªØ li·ªáu ƒë·∫ßu v√†o!", "success");
        logActivity("ƒê√£ x√≥a d·ªØ li·ªáu ƒë·∫ßu v√†o");
      }

      // X√≥a k·∫øt qu·∫£
      function clearResults() {
        document.getElementById("result").textContent =
          "K·∫øt qu·∫£ ki·ªÉm tra s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y...";
        document.getElementById("aiSuggestions").style.display = "none";
        updateStats(0, 0, 0, 0, 0, 0);
        showNotification("ƒê√£ x√≥a k·∫øt qu·∫£!", "success");
      }

      // Sao ch√©p k·∫øt qu·∫£
      function copyResults() {
        const resultText = document.getElementById("result").textContent;
        navigator.clipboard
          .writeText(resultText)
          .then(() => {
            showNotification("ƒê√£ sao ch√©p k·∫øt qu·∫£ v√†o clipboard!", "success");
            logActivity("ƒê√£ sao ch√©p k·∫øt qu·∫£ v√†o clipboard");
          })
          .catch((err) => {
            showNotification("L·ªói khi sao ch√©p k·∫øt qu·∫£!", "error");
          });
      }

      // T·∫£i d·ªØ li·ªáu m·∫´u
      function loadSampleData() {
        const sampleData = `https://qq88.traffic90.com/link1?comment_id=123456
https://traffic90.com/link2?comment_id=234567
https://qq88.traffic90.com/link3?comment_id=123456
https://traffic90.com/link4?comment_id=345678
https://qq88.traffic90.com/link5?comment_id=456789
https://traffic90.com/link6?comment_id=234567
https://qq88.traffic90.com/link7?comment_id=567890
https://traffic90.com/link8?comment_id=678901`;

        document.getElementById("input").value = sampleData;
        showNotification(
          "ƒê√£ t·∫£i d·ªØ li·ªáu m·∫´u (c·∫£ QQ88 v√† Traffic90)!",
          "success"
        );
        logActivity("ƒê√£ t·∫£i d·ªØ li·ªáu m·∫´u ƒë·ªÉ ki·ªÉm tra");

        // T·ª± ƒë·ªông ki·ªÉm tra n·∫øu ƒë∆∞·ª£c ch·ªçn
        if (document.getElementById("autoCheck").checked) {
          checkDup();
        }
      }

      // Xu·∫•t k·∫øt qu·∫£
      function exportResults(format) {
        const resultText = document.getElementById("result").textContent;
        if (
          !resultText ||
          resultText === "K·∫øt qu·∫£ ki·ªÉm tra s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y..."
        ) {
          showNotification("Kh√¥ng c√≥ k·∫øt qu·∫£ ƒë·ªÉ xu·∫•t!", "error");
          return;
        }

        let blob;
        if (format === "pdf") {
          // Gi·∫£ l·∫≠p xu·∫•t PDF
          showNotification(
            "T√≠nh nƒÉng xu·∫•t PDF ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn!",
            "warning"
          );
          return;
        } else {
          blob = new Blob([resultText], {
            type:
              format === "json"
                ? "application/json"
                : format === "csv"
                ? "text/csv"
                : "text/plain",
          });
        }

        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `comment_id_check_${new Date()
          .toISOString()
          .slice(0, 10)}.${format}`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);

        showNotification(
          `ƒê√£ xu·∫•t k·∫øt qu·∫£ d·∫°ng ${format.toUpperCase()}!`,
          "success"
        );
        logActivity(`ƒê√£ xu·∫•t k·∫øt qu·∫£ d·∫°ng ${format.toUpperCase()}`);
      }

      // L∆∞u v√†o l·ªãch s·ª≠
      function saveToHistory(
        text,
        totalIds,
        duplicates,
        uniques,
        qq88Count,
        traffic90Count
      ) {
        const historyItem = {
          timestamp: new Date().toISOString(),
          totalIds,
          duplicates,
          uniques,
          qq88Count,
          traffic90Count,
          preview: text.substring(0, 100) + (text.length > 100 ? "..." : ""),
        };

        checkHistory.unshift(historyItem);
        if (checkHistory.length > 10) {
          checkHistory = checkHistory.slice(0, 10);
        }

        localStorage.setItem(
          "commentIdCheckHistory",
          JSON.stringify(checkHistory)
        );
        renderHistory();
      }

      // Hi·ªÉn th·ªã l·ªãch s·ª≠
      function renderHistory() {
        const historyList = document.getElementById("historyList");

        if (checkHistory.length === 0) {
          historyList.innerHTML =
            '<p style="text-align: center; color: #7f8c8d; padding: 20px;">Ch∆∞a c√≥ l·ªãch s·ª≠ ki·ªÉm tra</p>';
          return;
        }

        let html = "";
        checkHistory.forEach((item, index) => {
          const date = new Date(item.timestamp).toLocaleString("vi-VN");
          const hasQq88 = item.qq88Count > 0;
          const hasTraffic90 = item.traffic90Count > 0;
          const safetyRate = Math.round((item.uniques / item.totalIds) * 100);

          html += `
                <div class="history-item ${
                  hasQq88 && !hasTraffic90 ? "qq88-item" : ""
                }">
                    <div class="history-info">
                        <strong>Ki·ªÉm tra l√∫c: ${date}</strong>
                        <div style="font-size: 14px; color: #7f8c8d;">
                            ${item.totalIds} ID, ${item.duplicates} tr√πng, ${
            item.uniques
          } duy nh·∫•t
                            ${
                              hasQq88
                                ? `<span class="domain-indicator qq88-indicator"></span>QQ88:${item.qq88Count}`
                                : ""
                            }
                            ${
                              hasTraffic90
                                ? `<span class="domain-indicator traffic90-indicator"></span>Traffic90:${item.traffic90Count}`
                                : ""
                            }
                            <span style="margin-left: 10px; color: ${
                              safetyRate > 80
                                ? "green"
                                : safetyRate > 60
                                ? "orange"
                                : "red"
                            }">An to√†n: ${safetyRate}%</span>
                        </div>
                        <div style="font-size: 12px; margin-top: 5px;">
                            ${item.preview}
                        </div>
                    </div>
                    <div class="history-actions">
                        <button class="secondary" onclick="loadFromHistory(${index})">T·∫£i l·∫°i</button>
                        <button class="qq88" onclick="removeFromHistory(${index})">X√≥a</button>
                    </div>
                </div>
                `;
        });

        historyList.innerHTML = html;
      }

      // T·∫£i t·ª´ l·ªãch s·ª≠
      function loadFromHistory(index) {
        if (checkHistory[index]) {
          // Trong th·ª±c t·∫ø, ch√∫ng ta s·∫Ω l∆∞u to√†n b·ªô vƒÉn b·∫£n g·ªëc
          // ·ªû ƒë√¢y ch·ªâ l√† minh h·ªça
          showNotification(
            "T√≠nh nƒÉng n√†y c·∫ßn l∆∞u to√†n b·ªô d·ªØ li·ªáu g·ªëc!",
            "warning"
          );
        }
      }

      // X√≥a kh·ªèi l·ªãch s·ª≠
      function removeFromHistory(index) {
        checkHistory.splice(index, 1);
        localStorage.setItem(
          "commentIdCheckHistory",
          JSON.stringify(checkHistory)
        );
        renderHistory();
        showNotification("ƒê√£ x√≥a m·ª•c kh·ªèi l·ªãch s·ª≠!", "success");
        logActivity("ƒê√£ x√≥a m·ªôt m·ª•c kh·ªèi l·ªãch s·ª≠ ki·ªÉm tra");
      }

      // T·ª± ƒë·ªông ki·ªÉm tra khi nh·∫≠p
      document.getElementById("input").addEventListener("input", function () {
        if (
          document.getElementById("autoCheck").checked &&
          this.value.trim().length > 0
        ) {
          // Debounce ƒë·ªÉ tr√°nh ki·ªÉm tra qu√° nhi·ªÅu l·∫ßn
          clearTimeout(this.debounce);
          this.debounce = setTimeout(() => {
            if (this.value.trim().length > 0) {
              checkDup();
            }
          }, 1500);
        }
      });

      // Ki·ªÉm tra n√¢ng cao
      function advancedValidation() {
        showNotification("ƒêang th·ª±c hi·ªán ki·ªÉm tra n√¢ng cao...", "success");
        // Th√™m logic ki·ªÉm tra n√¢ng cao ·ªü ƒë√¢y
        logActivity("ƒê√£ th·ª±c hi·ªán ki·ªÉm tra n√¢ng cao");
      }

      // T·∫°o b√°o c√°o
      function generateReport() {
        showNotification("ƒêang t·∫°o b√°o c√°o...", "success");
        // Th√™m logic t·∫°o b√°o c√°o ·ªü ƒë√¢y
        logActivity("ƒê√£ t·∫°o b√°o c√°o chi ti·∫øt");
      }

      // L∆∞u c√†i ƒë·∫∑t
      function saveSettings() {
        showNotification("ƒê√£ l∆∞u c√†i ƒë·∫∑t th√†nh c√¥ng!", "success");
        logActivity("ƒê√£ l∆∞u c√†i ƒë·∫∑t h·ªá th·ªëng");
      }

      // ƒê·∫∑t l·∫°i c√†i ƒë·∫∑t
      function resetSettings() {
        showNotification("ƒê√£ kh√¥i ph·ª•c c√†i ƒë·∫∑t m·∫∑c ƒë·ªãnh!", "success");
        logActivity("ƒê√£ ƒë·∫∑t l·∫°i c√†i ƒë·∫∑t h·ªá th·ªëng v·ªÅ m·∫∑c ƒë·ªãnh");
      }

      // Kh·ªüi t·∫°o
      document.addEventListener("DOMContentLoaded", function () {
        renderHistory();
        updateMonitorStats();

        // C·∫≠p nh·∫≠t hi·ªáu su·∫•t h·ªá th·ªëng
        document.getElementById("processingSpeed").textContent = "2500 links/s";
        document.getElementById("memoryUsage").textContent = "62 MB";
        document.getElementById("processingTime").textContent = "95 ms";

        console.log(
          "üöÄ ULTIMATE Comment_ID Checker (QQ88 & Traffic90) ƒë√£ s·∫µn s√†ng!"
        );
        logActivity("H·ªá th·ªëng kh·ªüi ƒë·ªông th√†nh c√¥ng");
      });
    </script>
  </body>
</html>
